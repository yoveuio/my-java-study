# netty私有协议栈的实现
## 消息的定义

## 可靠性设计

### 心跳机制

1. 客户端空闲T时间后向服务端发送ping消息
2. 服务端如果T时间没有收到客户端消息，心跳失败计数器+1，一定次数之后断开连接。如果在中间收到消息则清0

### 重连机制

### 重复登录保护

### 消息缓存重发

无论是客户端还是服务端，当发生链路中断之后，在链路恢复之前，缓存在消息队列中待发送的消息不能丢失。

考虑到内存溢出的风险，消息缓存队列有上限，达到上限之后拒绝继续向队列添加消息

## 安全性设计

内部长连接采用基于IP地址的安全认证机制，服务端对握手请求消息的IP地址进行合法性校验；如果在白名单之内，则校验通过；否则拒绝对方连接

如果Netty协议栈放在公网中使用需要采用更加严格的安全认证机制，例如基于密钥和AES加密的用户名+密码认证机制，也可以采用SSL/TSL安全传输



