# 线程简介

## 线程优先级

操作系统里面学习了现代操作系统基本采用时分的形式调度运行的线程，操作系统会分出一个个时间片，线程分配到的时间片多少就决定了线程使用处理器资源的多少，而线程优先级就是决定线程需要多或者少分配一些处理器资源的线程属性。

在Java线程中，通过一个整形变量`priority`控制优先级，优先级的范围从1~10，在线程构建的时候通过setPriority(int)方法修改优先级，默认优先级是5。

然而在很多系统会忽略线程优先级的设定。**线程优先级不能作为程序正确性的依赖**

## 线程的状态

Java在运行的声明周期中可能处于下表6种不同的状态，在任意一个时刻，线程只能处于其中的一个状态：

| 状态名称     | 说明                                                         |
| ------------ | ------------------------------------------------------------ |
| NEW          | 初始状态，线程被构建，但是还没有调用`start()`方法            |
| RUNNABLE     | 运行状态，Java线程将操作系统中的就绪和运行两种状态笼统称为“运行中” |
| BLOCKED      | 阻塞状态，表示线程阻塞于锁                                   |
| WAITING      | 等待状态，表示线程进入等待状态，这时当前线程需要其他线程通知或中断 |
| TIME_WAITING | 超时等待状态，它可以在指定时间自行返回                       |
| TERMINATED   | 终止状态，表示当前线程已经执行完毕                           |

![Java状态变迁](https://gitee.com/yovette/Images/raw/master/img/20201022202918.png)

## Daemon线程

`Daemon`是一种支持性线程，主要被用作程序中后台调度以及支持性工作。这意味着一个Java虚拟机不存在非Deamon线程时，Java虚拟机将会退出，可以通过调用`Thread.setDeamon(true)`设置Deamon线程

# 线程的运行

## 中断

中断可以理解为线程的一个标识位属性，它表示一个运行中的线程是否被其他线程进行了中断操作。中断好比其他线程对该线程打了个招呼，其他线程调用该线程的`interrupt()`方法对其进行中断操作。

线程通过检查可以通过`isInterrupt`方法来判断是否被中断，也可以调用静态方法`Thread.interrupted()`对当前线程的中断标识位进行复位。

Thread许多方法抛出`InterruptedException`之前会将中断标识位清除。

## 正确的终止程序运行

应当使用中断或者标识位停止程序，让程序有机会释放资源。