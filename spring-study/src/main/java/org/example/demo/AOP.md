# AOP的工作流程

AOP工作流程

1. 制作目标类(功能类)
2. 制作通知类
3. 配置切面

开发时，制作功能类(目标对象类)，将其中方法的通用功能抽取出来，制作成独立的类(通知类)，原始目标对象中的方法不再书写通用功能。通用功能被抽取之后，目标对象没有完整的业务逻辑，需要配置切面，生成代理对象将通知织入到切入点。

织入分成三个种类：编译期织入、装载时织入、运行时织入。其中spring是运行时织入。

> 编译器织入：执行时效率高，但是不灵活
>
> 装载时织入：稍微灵活，可以在JVM装载目标对象和声明类对象的时候进行合并
>
> 运行时织入：最灵活，通过配置文件进行目标类对象和通知进行合并，效率最低。

# 切入点表达式

```xml
<aop:config>
    <!--配置切面: 配置通知和切入点的关系，并将通知和切入点配置成受Spring管理的Bean
        ref指明哪个类是通知-->
    <aop:aspect ref="advice">
        <!--配置切面并将通知类和目标对象关联，关联使用execution表达式-->
        <aop:before method="printOne" pointcut="execution(public void org.example.demo.Target.method1())"/>
    </aop:aspect>
</aop:config>
```

作用：用来匹配切入点方法。

格式：$execution([方法的访问控制修饰符] 方法的返回值 包名.类名/接口方法名(参数))$

方法的访问修饰符可以省略

## 切入点表达式通配符

通配符：`*`，`..`(多个包或者多个参数)

1. 可以匹配返回值类型
2. 可以匹配包名
3. 可以匹配类名
4. 可以匹配方法名，`..`代表0—多个参数
5. 可以匹配参数

## 切入点配置方式

### 局部切入点

### 切面间共享切入点

```xml
<aop:pointcut id="method" expression="execution(void *..method*())"/>
```

### 切面内共享切入点

